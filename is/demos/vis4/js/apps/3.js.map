{"version":3,"sources":["/js/apps/3.js"],"names":[],"mappings":"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","file":"/js/apps/3.js","sourcesContent":["import { CreateScene, FetchData } from 'common';\nimport { conf__3 as conf } from 'conf';\nimport { Cube4 as Cube } from 'points';\n\nimport * as THREE from 'three';\n\n\nclass DataSeries {\n  constructor(__) {\n    this.__ = __;\n    this.hour = 0;\n    this.day = 220;\n    this.interval = __.conf.interval;\n    this.timer = null;\n    this.infourl = 'data/2015223-23.json';\n  }\n\n  next() {\n    function pad(num, size) {\n      var s = \"000000000\" + num;\n      return s.substr(s.length-size);\n    }\n\n    let dataurl = 'data/2015' + pad(this.day, 3) + '-' + pad(this.hour, 2) + '.data'; \n    FetchData(this.infourl, dataurl).then(::this.update);\n  }\n\n  update(data) {\n    let { __ } = this;\n\n    if (__.mesh) {\n      __.mesh.update(data); \n    } else {\n      this.createCube(data);\n    }\n    this.hour += 1;\n    if (this.hour == 24) {\n      this.day += 1;\n      this.hour = 0;\n      if (this.day > 229) {\n        this.day = 220;\n      }\n    }\n\n    setTimeout(::this.next, this.interval);\n  }\n\n  createCube(data) {\n    let emis = new Cube(__, data);\n    __.mesh = emis;\n    __.mesh.rotation.x = 0.5;\n    __.scene.add(emis);\n    __.camera = emis.createCamera();\n    document.addEventListener('mousemove', onDocumentMouseMove, false);\n    document.addEventListener('mouseup', onDocumentMouseUp, false);\n    document.addEventListener('mousedown', onDocumentMouseDown, false);\n    document.addEventListener('mousewheel', onDocumentMouseWheel, false);\n    render();\n  }\n}\n\n\n\nfunction render() {\n  requestAnimationFrame(render);\n  __.renderer.render(__.scene, __.camera);\n}\n\n\nFetchData('data/2015223-23.json').then(function(data) {\n  let emis = new Cube(__, data);\n  __.mesh = emis;\n  __.mesh.rotation.x = 0.5;\n  __.scene.add(emis);\n  __.camera = emis.createCamera();\n  \n  document.addEventListener('mousemove', onDocumentMouseMove, false);\n  document.addEventListener('mouseup', onDocumentMouseUp, false);\n  document.addEventListener('mousedown', onDocumentMouseDown, false);\n  document.addEventListener('mousewheel', onDocumentMouseWheel, false);\n  render();\n});\n\nfunction onDocumentMouseMove(event) {\n  if (__.mouse && __.mesh) {\n    let { clientX:x0, clientY:y0 } = event;\n    __.mesh.rotation.y += 0.005 * (x0 - __.mouse.x);\n    __.mesh.rotation.x += 0.005 * (y0 - __.mouse.y);\n    __.mouse.x = x0;\n    __.mouse.y = y0;\n  }\n}\n\nfunction onDocumentMouseDown(event) {\n  __.mouse = {\n    x: event.clientX,\n    y: event.clientY,\n  } \n}\n\nfunction onDocumentMouseUp(event) {\n  __.mouse = undefined;\n}\n\nfunction onDocumentMouseWheel(event) {\n  if (__.camera) {\n     __.camera.position.z *= 1000 / (1000.0 + event.deltaY);\n  }\n}\n\n\n// --- main\nvar __ = {};\n__.conf = conf;\nCreateScene(__, {});\n__.datas = new DataSeries(__);\n__.datas.next();\n"]}