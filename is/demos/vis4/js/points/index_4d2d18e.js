define("points/index",function(e,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(){var e=document.createElement("canvas"),t=256;e.width=t,e.height=t;var r=e.getContext("2d");r.imageSmoothingEnabled=!1,r.fillStyle="rgba(255, 255, 255, 0)",r.fillRect(0,0,t,t);var o=2*Math.PI;r.fillStyle="rgba(255, 255, 255, 255)",r.beginPath(),r.arc(t/2,t/2,t/2,0,o,!0),r.fill();var n=r.getImageData(0,0,t,t),a=new s.Texture(n);return a.needsUpdate=!0,a}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),u=function(e,t,r){for(var o=!0;o;){var n=e,a=t,i=r;o=!1,null===n&&(n=Function.prototype);var l=Object.getOwnPropertyDescriptor(n,a);if(void 0!==l){if("value"in l)return l.value;var u=l.get;return void 0===u?void 0:u.call(i)}var c=Object.getPrototypeOf(n);if(null===c)return void 0;e=c,t=a,r=i,o=!0,l=c=void 0}},c=e("three/build/three"),s=o(c),f=e("colormap/index"),d=r(f),h=24,p=d["default"]({colormap:"portland",nshades:24,format:"rgb"});console.log(p[23]),console.log(new s.Color(p[23]));var v=function(e){function t(e,r){n(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r),console.log("My Points")}return a(t,e),t}(s.Points),y=function(e){function t(e,r){n(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.root=e,this.data=Object.assign({},r,e.conf),this.sub={},e.conf.fence&&this.buildFence(),this.buildCloud()}return a(t,e),l(t,[{key:"buildCloud",value:function(){for(var e=this.data,t=(this.root,e.mass,e.lay),r=e.row,o=e.col,n=e.array.length,a=e.array,l=e.cellsize,u=e.cellheight,c=e.points,f=(new s.Group,0),d=0,y=0,b=0,w=0;n>w;++w)f+=a[w],a[w]>0&&(d+=a[w],y+=1),a[w]>b&&(b=a[w]);f=1.001*f;var g=f/c;console.log("stat",f,d,g,y,d/y,b),b=.6*b;for(var m=new Float32Array(3*c),O=new Float32Array(3*c),P=-o*l/2,A=-t*u/2,M=r*l/2,j=0,C=0,_=0,x=0,B=0,z=0,w=0;r*o*t>w;++w){B+=a[w];var S=Math.floor(a[w]/b*h);S>=h&&(S=h-1);for(var F=p[S],k=F[0]/255,E=F[1]/255,I=F[2]/255;B>0;)m[x]=(j+Math.random())*l+P,m[x+1]=_*Math.random()*u+A,m[x+2]=-(C+Math.random())*l+M,O[x]=k,O[x+1]=E,O[x+2]=I,x+=3,z+=1,B-=g;j+=1,j>=o&&(j=0,C+=1,C>=r&&(_+=1,C=0))}var D=m.slice(0,3*z),G=O.slice(0,3*z),T=new s.BufferGeometry;T.addAttribute("position",new s.BufferAttribute(D,3)),T.addAttribute("color",new s.BufferAttribute(G,3)),T.computeBoundingSphere();{var V=null;i()}V=new s.PointsMaterial({transparent:!0,vertexColors:s.VertexColors,size:e.pointSize,opacity:e.opacity,sizeAttenuation:e.sizeAttenuation}),V.map=i(),console.log(V);var R=new v(T,V);return this.sub.cloud=R,this.add(R),this}},{key:"buildFence",value:function(){for(var e=this.data,t=e.lay,r=e.row,o=e.col,n=e.cellsize,a=e.cellheight,i=new s.MeshBasicMaterial({color:e.fenceColor,opacity:e.fenceOpacity,side:s.DoubleSide,transparent:!0}),l=new Float32Array(24),u=o*n/2,c=t*a/2,f=-r*n/2,d=0,h=0;1>=h;++h)for(var p=0;1>=p;++p)for(var v=0;1>=v;++v)l[d]=h*o*n-u,l[d+1]=p*t*a-c,l[d+2]=-v*r*n-f,d+=3;var y=Int16Array.from([2,0,1,2,1,3,3,1,5,3,5,7,7,4,5,7,6,4,6,0,2,6,4,0]);y=Int16Array.from([0,1,5,0,5,4]);var b=new s.BufferGeometry;b.addAttribute("position",new s.BufferAttribute(l,3)),b.setIndex(new s.BufferAttribute(y,1));var w=new s.Mesh(b,i);return this.add(w),this.sub.fence=w,this}},{key:"createCamera",value:function(){var e=this.root,t=this.data,r=e.renderer,o=r.domElement,n=o.width,a=o.height,i=t.cellsize,l=(t.cellheight,t.row),u=(t.col,t.lay,new s.PerspectiveCamera(45,n/a,1,1e7));return u.position.set(0,0,l*i*1.4),u.lookAt(new s.Vector3(0,0,0)),u.updateProjectionMatrix(),u}}]),t}(s.Object3D);t.Cube=y});